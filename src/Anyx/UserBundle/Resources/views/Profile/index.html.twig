{% extends '::main.html.twig' %}

{% block javascripts %}
	{{ parent() }}

	{% javascripts
		'@AnyxCrosswordBundle/Resources/public/js/jquery.min.js'
		'@AnyxCrosswordBundle/Resources/public/js/jquery-ui.min.js'
	
		'@AnyxCrosswordBundle/Resources/public/js/json2.js'
		'@AnyxCrosswordBundle/Resources/public/js/underscore.js'
		'@AnyxCrosswordBundle/Resources/public/js/backbone.js'
		
		'@AnyxCrosswordBundle/Resources/public/js/views/View.js'

		'@AnyxCrosswordBundle/Resources/public/js/models/Crossword.js'
		'@AnyxUserBundle/Resources/public/js/models/Crossword.js'
		'@AnyxUserBundle/Resources/public/js/models/CrosswordCollection.js'

		'@AnyxUserBundle/Resources/public/js/models/Solution.js'
		'@AnyxUserBundle/Resources/public/js/models/SolutionCollection.js'

		'@AnyxUserBundle/Resources/public/js/ProfileWorkspace.js'

		'@AnyxUserBundle/Resources/public/js/views/Profile.js'

	%}
	<script type="text/javascript" src="{{ asset_url }}"></script>
	{% endjavascripts %}
	
	<script type="text/javascript">
		$(function() {
			
			var workspace = new Anyx.Profile.Workspace({
				document	: window.document,
				views		: {
					solved	: new Anyx.View({
						el			: $('#i-solutions'),
						template	: 't-solutions'
					})
				}
			});

			var profileView = new Anyx.View.Profile({
				el			: $('#i-profile-menu'),
				template	: 't-profile-menu'
			});
			
			profileView.render({
				links		: workspace.routes,
				translation	: []
			});

			Backbone.history.start();
		});
	</script>			
	
{% endblock %}	

{% block page_title %}
	{%trans%}User profile{%endtrans%}
{% endblock %}
	
{% block body %}
	<h4>{% trans %}Created crosswords{%endtrans%}</h4>
	<h4>{% trans %}Solved crosswords{%endtrans%}</h4>
	
	<div id="i-profile-menu">
	</div>
	
	<div id="i-profile-page">
		<div id="i-solutions">
		</div>
	</div>
	
	<script type="text/template" id="t-profile-menu">
		<ul>
			<% _.each(links, function( name, link ) { %>
			<li><a href="#<%=link%>"><%=name%></a></li>
			<% }); %>
		</ul>	
	</script>

	<script type="text/template" id="t-solutions">
		<table>
		<thead>
			<th>{%trans%}Crossword{%endtrans%}</th>
			<th>{%trans%}Solution date{%endtrans%}</th>
			<th>{%trans%}Correct{%endtrans%}</th>
		</thead>
		<tbody>
		<% if ( !_.isEmpty( solutions ) ) { %>
			<% _.each(solutions, function( solution ) { %>
			<tr>
				<td>
					<a href="#"><%=solution.get('crossword').title%></a>
					<p>
						<%=solution.get('crossword').description%>
					</p>
				</td>
				<td><%=solution.get('updated_at')%></td>
				<td><%=solution.get('is_correct')%></td>
			</tr>
			<% }); %>
		<% } else { %>
			<tr>
				<td colspan="3">
					{%trans%}Solutions not found{%endtrans%}
					<a href="#">{%trans%}Want now?{%endtrans%}</a>
				</td>
			</tr>
		<% } %>
		</tbody>
		</table>	
	</script>
	
	
{% endblock body %}
	